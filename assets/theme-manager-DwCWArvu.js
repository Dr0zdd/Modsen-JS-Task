(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const n of i.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&o(n)}).observe(document,{childList:!0,subtree:!0});function s(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(r){if(r.ep)return;r.ep=!0;const i=s(r);fetch(r.href,i)}})();let a="unsplash-favorites";function l(){try{const t=localStorage.getItem(a),e=JSON.parse(t);return Array.isArray(e)?e:[]}catch{return console.warn("favoritesStorage: некорректные данные в localStorage"),[]}}function d(t){return l().some(e=>e.id===t)}function f(t){if(!t?.id||!t?.url)return;const e=l();e.some(s=>s.id===t.id)||(e.push({id:t.id,url:t.url,alt:t.alt||""}),localStorage.setItem(a,JSON.stringify(e)))}function p(t){const e=l().filter(s=>s.id!==t);localStorage.setItem(a,JSON.stringify(e))}function y(){localStorage.removeItem(a)}class E{constructor(e,s=0){this.images=e,this.currentIndex=s,this.modal=null,this.imageElement=null,this.favBtn=null}buildModal(){this.modal=document.createElement("div"),this.modal.className="modal";const e=this.createElement("div","modal__overlay",()=>this.closeModal()),s=this.createElement("div","modal__content"),o=this.createElement("div","modal__img-wrapper");this.imageElement=this.createElement("img","modal__img"),this.setImage();const r=this.createElement("button","modal__close",()=>this.closeModal()),i=this.createElement("button","modal__prev",()=>this.prevImage()),n=this.createElement("button","modal__next",()=>this.nextImage());this.favBtn=this.createElement("button","modal__fav-btn",()=>this.toggleFavorite()),this.updateFavIcon(),o.append(this.imageElement,this.favBtn,r),s.append(i,o,n),this.modal.append(e,s),document.body.appendChild(this.modal),setTimeout(()=>{this.modal.classList.add("active"),document.body.style.overflow="hidden",document.querySelector(".card__wrapper")?.classList.add("blurred")},10)}createElement(e,s,o=null){const r=document.createElement(e);return r.className=s,o&&r.addEventListener("click",o),r}getCurrentItem(){const e=this.images[this.currentIndex];if(typeof e=="object"){if("url"in e)return{id:e.id,url:e.url,alt:e.alt||""};if("urls"in e)return{id:e.id,url:e.urls?.regular,alt:e.alt_description||""}}return{id:String(this.currentIndex),url:e,alt:""}}setImage(){const{url:e,alt:s}=this.getCurrentItem();this.imageElement.src=e,this.imageElement.alt=s}updateImage(){this.setImage(),this.updateFavIcon()}getCurrentId(){return this.getCurrentItem().id}updateFavIcon(e=!1){const s=this.getCurrentId(),o=d(s)?"heart-filled.svg":"heart-outline.svg";this.favBtn.innerHTML=`<img src="../src/img/${o}" alt="Favorite">`,e&&(this.favBtn.classList.add("clicked"),setTimeout(()=>this.favBtn.classList.remove("clicked"),300))}toggleFavorite(){const e=this.getCurrentItem();e?.id&&(d(e.id)?p(e.id):f(e),this.updateFavIcon(!0))}prevImage(){this.currentIndex=(this.currentIndex-1+this.images.length)%this.images.length,this.updateImage()}nextImage(){this.currentIndex=(this.currentIndex+1)%this.images.length,this.updateImage()}closeModal(){this.modal.classList.remove("active"),setTimeout(()=>{this.modal.remove(),document.body.style.overflow="",document.querySelector(".card__wrapper")?.classList.remove("blurred")},300)}}const c="user-preferred-theme",m="light",u=document.querySelector("[data-theme-toggler]"),h=document.querySelector(".theme-list");function g(t){document.documentElement.setAttribute("data-theme",t),localStorage.setItem(c,t),I(t)}function v(){const e=localStorage.getItem(c)||m;g(e)}function I(t){const e={light:"../src/img/sun-solid.svg",dark:"../src/img/moon-solid.svg",pastel:"../src/img/rainbow.png"};u.innerHTML=`<img src="${e[t]}" alt="${t} icon"/>`}u.addEventListener("click",()=>{const t=localStorage.getItem(c)||m;h.classList.toggle("hidden"),document.querySelectorAll("[data-theme-option]").forEach(e=>{const s=e.dataset.themeOption;e.classList.toggle("active",s===t)})});document.querySelectorAll("[data-theme-option]").forEach(t=>{t.addEventListener("click",()=>{const e=t.dataset.themeOption;g(e),h.classList.add("hidden")})});v();export{E as I,y as c,l as g};
